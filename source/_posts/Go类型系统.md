---
title: Go类型系统
date: 2021-10-13 15:15:56
tags: 
- GoLang
categories: 学习
---
-
<!-- more -->

## 类型是什么

计算机只能理解0和1，只认识一堆存有0和1的寄存器，所以类型是编程语言基于汇编语言的一种抽象实现，它能够把我们写的类型**值**按照一种特定的方式转化为汇编语言。

## 类型系统是什么

任何语言都有自己的类型系统，任何“值”也都唯一的属于某种类型。

一个“值”只有有自己的类型，才能被编译器所识别，从而正确的为其分配内存和使用。

类型为编译器提供了两种信息：

1. 类型的规模，即需要为该种类型的“值”分配多少内存；
2. 内存的表示，即这段内存表示的是什么。

**所以一个语言的类型系统指明：哪些操作对哪些类型是有效的。(一个类型允许进行哪些操作)用于强制这些二进制数据按照我们预期的值来解析，确保在一个整数的二进制格式上不会做任何非整数的操作，从而获取一些毫无意义的东西。**

## GoLang类型元数据

类型元数据承载了一个类型的所有信息，每种数据的类型元数据全局唯一。如下图所示，第一个方框格为每个类型元数据的Header，存放了名字、对其边界等必备信息，中间的方框格用来存放一些补充信息，如果是自定义类型，则会有第三个方框格，记录类型的包路径、方法个数、和一个记录了方法元数据数组的指针。

![Alt text](/images/post1.png)


一个[]String类型的元数据如下

![Alt text](/images/post2.png)

## type MyType1 int32和type MyType2=int32的区别

前者是类型别名写法不创建新的类型元数据，后者是创建新的自定义类型，会创建新的类型元数据

![Alt text](/images/post3.png)



## 命名类型和未命名类型

具有名称的类型就是命名类型，例如：`int`, `int64`, `float32`, `string`, `bool`等。

没有名称的类型就是未命名类型，例如数组，结构体，指针，函数，接口，切片，map，通道 都是未命名类型。【我的理解就是引用类型都是未命名类型】

## 底层类型

GoLang中，每个类型都有自己的底层类型【我猜测就是类型元数据中的Head】，底层类型在类型转换和赋值、比较中扮演着重要的属性。

- 底层类型为内置类型`bool`的类型称为**布尔类型**；
- 底层类型为任一内置整数类型的类型称为**整数类型**；
- 底层类型为内置类型`float32`或者`float64`的类型称为**浮点数类型**；
- 底层类型为内置类型`complex64`或`complex128`的类型称为**复数类型**；
- 整数类型、浮点数类型和复数类型统称为**数字值类型**；
- 底层类型为内置类型`string`的类型称为**字符串类型**。

## 赋值条件

双方应该具有相同的基础类型，而且其中至少有一个不是命名类型(至少有一个是未命名变类型)。

## reflect

反射的原理就是将暴露类型的元数据给我们用

## 参考资料

[深入研究Go(golang) Type类型系统](https://www.jianshu.com/p/ce307b8e9772)

[GO的类型系统和类型的方法](https://zhuanlan.zhihu.com/p/139347413)

[Go101类型系统概述](https://gfw.go101.org/article/type-system-overview.html)

[GoLang类型系统](https://blog.csdn.net/weixin_36228538/article/details/115111509)

[幼麟实验室](https://www.bilibili.com/video/BV1hv411x7we?p=12)